(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
const api = {
  getAllInterests() {
    return fetch("http://localhost:8088/interests?_expand=place").then(response => response.json());
  },

  getInterest(interestId) {
    return fetch(`http://localhost:8088/interests/${interestId}`).then(response => response.json());
  },

  getPlaces() {
    return fetch("http://localhost:8088/places").then(response => response.json());
  },

  postInterest(newInterest) {
    return fetch("http://localhost:8088/interests", {
      method: "POST",
      headers: {
        "content-type": "application/json"
      },
      body: JSON.stringify(newInterest)
    }).then(results => results.json());
  },

  patchInterest(interestId) {
    return fetch(`http://localhost:8088/interests/${interestId}`, {
      method: "POST",
      headers: {
        "content-type": "application/json"
      },
      body: JSON.stringify(newInterest)
    });
  }

};
var _default = api;
exports.default = _default;

},{}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _buildHTML = _interopRequireDefault(require("./buildHTML"));

var _apiManager = _interopRequireDefault(require("./apiManager"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const appendHTML = {
  appendInterests() {
    return _apiManager.default.getAllInterests().then(interests => {
      interests.forEach(interest => {
        // console.log(interest.cost)
        _buildHTML.default.buildInterest(interest.name, interest.description, interest.cost, interest.review, interest.place.name, interest.id);
      });
    });
  }

};
var _default = appendHTML;
exports.default = _default;

},{"./apiManager":1,"./buildHTML":3}],3:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _htmlFactory = _interopRequireDefault(require("./htmlFactory"));

var _apiManager = _interopRequireDefault(require("./apiManager"));

var _eventHandlers = _interopRequireDefault(require("./eventHandlers"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const displayContainer = document.getElementById("display-container");
const buildHTML = {
  buildInterest(name, description, cost, review, place, id) {
    let containerDiv = document.createElement("div");
    containerDiv.id = `interest-div--${id}`;
    let interestName = document.createElement("h2");
    interestName.textContent = name;
    containerDiv.appendChild(interestName);
    let interestDescription = document.createElement("p");
    interestDescription.textContent = description;
    containerDiv.appendChild(interestDescription);
    let interestCost = document.createElement("p");
    interestCost.textContent = cost;
    containerDiv.appendChild(interestCost);

    if (review !== "") {
      let interestReview = document.createElement("p");
      interestReview.textContent = review;
      containerDiv.appendChild(interestReview);
    }

    let interestPlace = document.createElement("p");
    interestPlace.textContent = place;
    containerDiv.appendChild(interestPlace);
    let editButton = document.createElement("button");
    editButton.textContent = "Edit Interest";
    editButton.id = `edit-button--${id}`;
    editButton.addEventListener("click", _eventHandlers.default.handleEditInterest);
    containerDiv.appendChild(editButton);
    containerDiv.appendChild(document.createElement("hr"));
    displayContainer.appendChild(containerDiv);
    return containerDiv;
  },

  buildNewInterestForm() {
    let newInterestForm = document.createElement("form");
    let formLabel = document.createElement("label");
    formLabel.textContent = "CREATE NEW POINT OF INTEREST";
    newInterestForm.appendChild(formLabel);
    newInterestForm.appendChild(_htmlFactory.default.buildRequiredFieldset("Name", "Please enter point of interest name", "name-input"));
    newInterestForm.appendChild(_htmlFactory.default.buildRequiredFieldset("Description", "Please enter description", "description-input"));
    newInterestForm.appendChild(_htmlFactory.default.buildFieldset("Cost", "Please enter cost", "cost-input"));
    newInterestForm.appendChild(_htmlFactory.default.buildFieldset("Review", "Please enter your review", "review-input"));
    let dropdownFieldset = document.createElement("fieldset");
    let dropdownLabel = document.createElement("label");
    dropdownLabel.textContent = "Choose location";
    dropdownFieldset.appendChild(dropdownLabel);
    let dropdown = document.createElement("select");
    dropdown.id = "dropdown";
    dropdown.name = "location";

    _apiManager.default.getPlaces().then(places => {
      places.forEach(place => {
        return dropdown.appendChild(_htmlFactory.default.buildOption(place.name, place.id));
      });
    }).then(() => {
      dropdownFieldset.appendChild(dropdown);
      newInterestForm.appendChild(dropdownFieldset);
      let saveButton = document.createElement("button");
      saveButton.textContent = "Save Point Of Interest";
      saveButton.addEventListener("click", _eventHandlers.default.handleSaveInterest);
      newInterestForm.appendChild(saveButton);
      displayContainer.appendChild(newInterestForm);
      return newInterestForm;
    });
  },

  buildEditForm(name, description, cost, review, place) {
    let documentFrag = document.createDocumentFragment();
    let interestName = document.createElement("h2");
    interestName.textContent = name;
    documentFrag.appendChild(interestName);
    let interestDescription = document.createElement("p");
    interestDescription.textContent = description;
    documentFrag.appendChild(interestDescription);
    let costInput = document.createElement("input");
    costInput.id = "edit-cost";

    if (cost !== "") {
      costInput.placeholder = cost;
    } else {
      costInput.placeholder = "Please enter cost";
    }

    documentFrag.appendChild(costInput);
    let reviewInput = document.createElement("input");
    reviewInput.id = "edit-review";

    if (review !== "") {
      reviewInput.placeholder = review;
    } else {
      reviewInput.placeholder = "Please enter review";
    }

    documentFrag.appendChild(reviewInput);
    let saveButton = document.createElement("button");
    saveButton.textContent = "Save Changes"; // saveButton.addEventListener("click", eventHandlers.handleSaveInterest)

    documentFrag.appendChild(saveButton);
    return documentFrag;
  }

};
var _default = buildHTML;
exports.default = _default;

},{"./apiManager":1,"./eventHandlers":4,"./htmlFactory":5}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _apiManager = _interopRequireDefault(require("./apiManager"));

var _htmlFactory = _interopRequireDefault(require("./htmlFactory"));

var _buildHTML = _interopRequireDefault(require("./buildHTML"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const eventHandlers = {
  handleSaveInterest() {
    let place = document.getElementById("dropdown").value;
    let name = document.getElementById("name-input").value;
    let description = document.getElementById("description-input").value;
    let cost = Number(document.getElementById("cost-input").value);
    let review = document.getElementById("review-input").value;

    if (name === "" || description === "") {
      return false;
    } else {
      _apiManager.default.postInterest(_htmlFactory.default.createInterestObject(place, name, description, cost, review));
    }
  },

  handleEditInterest() {
    let interestId = event.target.id.split("--")[1];
    let interestDiv = document.getElementById(`interest-div--${interestId}`);
    interestDiv.textContent = "";

    _apiManager.default.getInterest(interestId).then(interest => {
      return interestDiv.appendChild(_buildHTML.default.buildEditForm(interest.name, interest.description, interest.cost, interest.review));
    });
  }

};
var _default = eventHandlers;
exports.default = _default;

},{"./apiManager":1,"./buildHTML":3,"./htmlFactory":5}],5:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
const htmlFactory = {
  buildRequiredFieldset(labelText, placeholderText, inputId) {
    let fieldsetEl = document.createElement("fieldset");
    let labelEl = document.createElement("label");
    labelEl.textContent = labelText;
    fieldsetEl.appendChild(labelEl);
    let inputEl = document.createElement("input");
    inputEl.id = inputId;
    inputEl.setAttribute("required", "");
    inputEl.required = true;
    inputEl.placeholder = placeholderText;
    fieldsetEl.appendChild(inputEl);
    return fieldsetEl;
  },

  buildFieldset(labelText, placeholderText, inputId) {
    let fieldsetEl = document.createElement("fieldset");
    let labelEl = document.createElement("label");
    labelEl.textContent = labelText;
    fieldsetEl.appendChild(labelEl);
    let inputEl = document.createElement("input");
    inputEl.id = inputId;
    inputEl.placeholder = placeholderText;
    fieldsetEl.appendChild(inputEl);
    return fieldsetEl;
  },

  buildOption(name, id) {
    let option = document.createElement("option");
    option.value = id;
    option.textContent = name;
    return option;
  },

  createInterestObject(placeId, name, description, cost, review) {
    return {
      "placeId": placeId,
      "name": name,
      "description": description,
      "cost": cost,
      "review": review
    };
  }

};
var _default = htmlFactory;
exports.default = _default;

},{}],6:[function(require,module,exports){
"use strict";

var _appendHTML = _interopRequireDefault(require("./appendHTML"));

var _buildHTML = _interopRequireDefault(require("./buildHTML"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

_appendHTML.default.appendInterests().then(_buildHTML.default.buildNewInterestForm);

},{"./appendHTML":2,"./buildHTML":3}]},{},[6])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIuLi9zY3JpcHRzL2FwaU1hbmFnZXIuanMiLCIuLi9zY3JpcHRzL2FwcGVuZEhUTUwuanMiLCIuLi9zY3JpcHRzL2J1aWxkSFRNTC5qcyIsIi4uL3NjcmlwdHMvZXZlbnRIYW5kbGVycy5qcyIsIi4uL3NjcmlwdHMvaHRtbEZhY3RvcnkuanMiLCIuLi9zY3JpcHRzL21haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUNBQSxNQUFNLEdBQUcsR0FBRztBQUNSLEVBQUEsZUFBZSxHQUFHO0FBQ2QsV0FBTyxLQUFLLENBQUMsK0NBQUQsQ0FBTCxDQUNGLElBREUsQ0FDRyxRQUFRLElBQUksUUFBUSxDQUFDLElBQVQsRUFEZixDQUFQO0FBRUgsR0FKTzs7QUFLUixFQUFBLFdBQVcsQ0FBQyxVQUFELEVBQWE7QUFDcEIsV0FBTyxLQUFLLENBQUUsbUNBQWtDLFVBQVcsRUFBL0MsQ0FBTCxDQUNGLElBREUsQ0FDRyxRQUFRLElBQUksUUFBUSxDQUFDLElBQVQsRUFEZixDQUFQO0FBRUgsR0FSTzs7QUFTUixFQUFBLFNBQVMsR0FBRztBQUNSLFdBQU8sS0FBSyxDQUFDLDhCQUFELENBQUwsQ0FDRixJQURFLENBQ0csUUFBUSxJQUFJLFFBQVEsQ0FBQyxJQUFULEVBRGYsQ0FBUDtBQUVILEdBWk87O0FBYVIsRUFBQSxZQUFZLENBQUMsV0FBRCxFQUFjO0FBQ3RCLFdBQU8sS0FBSyxDQUFDLGlDQUFELEVBQW9DO0FBQzVDLE1BQUEsTUFBTSxFQUFFLE1BRG9DO0FBRTVDLE1BQUEsT0FBTyxFQUFFO0FBQ0wsd0JBQWdCO0FBRFgsT0FGbUM7QUFLNUMsTUFBQSxJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQUwsQ0FBZSxXQUFmO0FBTHNDLEtBQXBDLENBQUwsQ0FNSixJQU5JLENBTUMsT0FBTyxJQUFJLE9BQU8sQ0FBQyxJQUFSLEVBTlosQ0FBUDtBQU9ILEdBckJPOztBQXNC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LE9BQU8sQ0FBQyxFQUFSLEdBQWEsT0FBYjtBQUNBLElBQUEsT0FBTyxDQUFDLFdBQVIsR0FBc0IsZUFBdEI7QUFDQSxJQUFBLFVBQVUsQ0FBQyxXQUFYLENBQXVCLE9BQXZCO0FBQ0EsV0FBTyxVQUFQO0FBQ0gsR0F4QmU7O0FBeUJoQixFQUFBLFdBQVcsQ0FBQyxJQUFELEVBQU8sRUFBUCxFQUFXO0FBQ2xCLFFBQUksTUFBTSxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLFFBQXZCLENBQWI7QUFDQSxJQUFBLE1BQU0sQ0FBQyxLQUFQLEdBQWUsRUFBZjtBQUNBLElBQUEsTUFBTSxDQUFDLFdBQVAsR0FBcUIsSUFBckI7QUFDQSxXQUFPLE1BQVA7QUFDSCxHQTlCZTs7QUErQmhCLEVBQUEsb0JBQW9CLENBQUMsT0FBRCxFQUFVLElBQVYsRUFBZ0IsV0FBaEIsRUFBNkIsSUFBN0IsRUFBbUMsTUFBbkMsRUFBMkM7QUFDM0QsV0FBTztBQUNILGlCQUFXLE9BRFI7QUFFSCxjQUFRLElBRkw7QUFHSCxxQkFBZSxXQUhaO0FBSUgsY0FBUSxJQUpMO0FBS0gsZ0JBQVU7QUFMUCxLQUFQO0FBT0g7O0FBdkNlLENBQXBCO2VBMENlLFc7Ozs7OztBQzFDZjs7QUFDQTs7OztBQUVBLG9CQUFXLGVBQVgsR0FBNkIsSUFBN0IsQ0FBa0MsbUJBQVUsb0JBQTVDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiY29uc3QgYXBpID0ge1xyXG4gICAgZ2V0QWxsSW50ZXJlc3RzKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChcImh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pbnRlcmVzdHM/X2V4cGFuZD1wbGFjZVwiKVxyXG4gICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICB9LFxyXG4gICAgZ2V0SW50ZXJlc3QoaW50ZXJlc3RJZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgaHR0cDovL2xvY2FsaG9zdDo4MDg4L2ludGVyZXN0cy8ke2ludGVyZXN0SWR9YClcclxuICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxyXG4gICAgfSxcclxuICAgIGdldFBsYWNlcygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goXCJodHRwOi8vbG9jYWxob3N0OjgwODgvcGxhY2VzXCIpXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgIH0sXHJcbiAgICBwb3N0SW50ZXJlc3QobmV3SW50ZXJlc3QpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goXCJodHRwOi8vbG9jYWxob3N0OjgwODgvaW50ZXJlc3RzXCIsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkobmV3SW50ZXJlc3QpXHJcbiAgICAgICAgfSkudGhlbihyZXN1bHRzID0+IHJlc3VsdHMuanNvbigpKVxyXG4gICAgfSxcclxuICAgIHBhdGNoSW50ZXJlc3QoaW50ZXJlc3RJZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgaHR0cDovL2xvY2FsaG9zdDo4MDg4L2ludGVyZXN0cy8ke2ludGVyZXN0SWR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShuZXdJbnRlcmVzdClcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhcGkiLCJpbXBvcnQgYnVpbGRIVE1MIGZyb20gXCIuL2J1aWxkSFRNTFwiXHJcbmltcG9ydCBhcGlNYW5hZ2VyIGZyb20gXCIuL2FwaU1hbmFnZXJcIlxyXG5cclxuY29uc3QgYXBwZW5kSFRNTCA9IHtcclxuICAgIGFwcGVuZEludGVyZXN0cygpIHtcclxuICAgICAgICByZXR1cm4gYXBpTWFuYWdlci5nZXRBbGxJbnRlcmVzdHMoKVxyXG4gICAgICAgICAgICAudGhlbihpbnRlcmVzdHMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaW50ZXJlc3RzLmZvckVhY2goaW50ZXJlc3QgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGludGVyZXN0LmNvc3QpXHJcbiAgICAgICAgICAgICAgICAgICAgYnVpbGRIVE1MLmJ1aWxkSW50ZXJlc3QoaW50ZXJlc3QubmFtZSwgaW50ZXJlc3QuZGVzY3JpcHRpb24sIGludGVyZXN0LmNvc3QsIGludGVyZXN0LnJldmlldywgaW50ZXJlc3QucGxhY2UubmFtZSwgaW50ZXJlc3QuaWQpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhcHBlbmRIVE1MIiwiaW1wb3J0IGh0bWxGYWN0b3J5IGZyb20gXCIuL2h0bWxGYWN0b3J5XCJcclxuaW1wb3J0IGFwaU1hbmFnZXIgZnJvbSBcIi4vYXBpTWFuYWdlclwiXHJcbmltcG9ydCBldmVudEhhbmRsZXJzIGZyb20gXCIuL2V2ZW50SGFuZGxlcnNcIlxyXG5cclxuY29uc3QgZGlzcGxheUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGlzcGxheS1jb250YWluZXJcIik7XHJcblxyXG5jb25zdCBidWlsZEhUTUwgPSB7XHJcbiAgICBidWlsZEludGVyZXN0KG5hbWUsIGRlc2NyaXB0aW9uLCBjb3N0LCByZXZpZXcsIHBsYWNlLCBpZCkge1xyXG4gICAgICAgIGxldCBjb250YWluZXJEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGNvbnRhaW5lckRpdi5pZCA9IGBpbnRlcmVzdC1kaXYtLSR7aWR9YDtcclxuICAgICAgICBsZXQgaW50ZXJlc3ROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgyXCIpO1xyXG4gICAgICAgIGludGVyZXN0TmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgY29udGFpbmVyRGl2LmFwcGVuZENoaWxkKGludGVyZXN0TmFtZSk7XHJcbiAgICAgICAgbGV0IGludGVyZXN0RGVzY3JpcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICAgICAgICBpbnRlcmVzdERlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgICAgICAgY29udGFpbmVyRGl2LmFwcGVuZENoaWxkKGludGVyZXN0RGVzY3JpcHRpb24pO1xyXG4gICAgICAgIGxldCBpbnRlcmVzdENvc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICAgICAgICBpbnRlcmVzdENvc3QudGV4dENvbnRlbnQgPSBjb3N0O1xyXG4gICAgICAgIGNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZChpbnRlcmVzdENvc3QpO1xyXG4gICAgICAgIGlmIChyZXZpZXcgIT09IFwiXCIpIHtcclxuICAgICAgICAgICAgbGV0IGludGVyZXN0UmV2aWV3ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcbiAgICAgICAgICAgIGludGVyZXN0UmV2aWV3LnRleHRDb250ZW50ID0gcmV2aWV3O1xyXG4gICAgICAgICAgICBjb250YWluZXJEaXYuYXBwZW5kQ2hpbGQoaW50ZXJlc3RSZXZpZXcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaW50ZXJlc3RQbGFjZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG4gICAgICAgIGludGVyZXN0UGxhY2UudGV4dENvbnRlbnQgPSBwbGFjZTtcclxuICAgICAgICBjb250YWluZXJEaXYuYXBwZW5kQ2hpbGQoaW50ZXJlc3RQbGFjZSk7XHJcbiAgICAgICAgbGV0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgICAgIGVkaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIkVkaXQgSW50ZXJlc3RcIjtcclxuICAgICAgICBlZGl0QnV0dG9uLmlkID0gYGVkaXQtYnV0dG9uLS0ke2lkfWA7XHJcbiAgICAgICAgZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZXZlbnRIYW5kbGVycy5oYW5kbGVFZGl0SW50ZXJlc3QpO1xyXG4gICAgICAgIGNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZChlZGl0QnV0dG9uKTtcclxuICAgICAgICBjb250YWluZXJEaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImhyXCIpKTtcclxuICAgICAgICBkaXNwbGF5Q29udGFpbmVyLmFwcGVuZENoaWxkKGNvbnRhaW5lckRpdik7XHJcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lckRpdjtcclxuICAgIH0sXHJcbiAgICBidWlsZE5ld0ludGVyZXN0Rm9ybSgpIHtcclxuICAgICAgICBsZXQgbmV3SW50ZXJlc3RGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIik7XHJcbiAgICAgICAgbGV0IGZvcm1MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKVxyXG4gICAgICAgIGZvcm1MYWJlbC50ZXh0Q29udGVudCA9IFwiQ1JFQVRFIE5FVyBQT0lOVCBPRiBJTlRFUkVTVFwiXHJcbiAgICAgICAgbmV3SW50ZXJlc3RGb3JtLmFwcGVuZENoaWxkKGZvcm1MYWJlbCk7XHJcbiAgICAgICAgbmV3SW50ZXJlc3RGb3JtLmFwcGVuZENoaWxkKGh0bWxGYWN0b3J5LmJ1aWxkUmVxdWlyZWRGaWVsZHNldChcIk5hbWVcIiwgXCJQbGVhc2UgZW50ZXIgcG9pbnQgb2YgaW50ZXJlc3QgbmFtZVwiLCBcIm5hbWUtaW5wdXRcIikpO1xyXG4gICAgICAgIG5ld0ludGVyZXN0Rm9ybS5hcHBlbmRDaGlsZChodG1sRmFjdG9yeS5idWlsZFJlcXVpcmVkRmllbGRzZXQoXCJEZXNjcmlwdGlvblwiLCBcIlBsZWFzZSBlbnRlciBkZXNjcmlwdGlvblwiLCBcImRlc2NyaXB0aW9uLWlucHV0XCIpKTtcclxuICAgICAgICBuZXdJbnRlcmVzdEZvcm0uYXBwZW5kQ2hpbGQoaHRtbEZhY3RvcnkuYnVpbGRGaWVsZHNldChcIkNvc3RcIiwgXCJQbGVhc2UgZW50ZXIgY29zdFwiLCBcImNvc3QtaW5wdXRcIikpO1xyXG4gICAgICAgIG5ld0ludGVyZXN0Rm9ybS5hcHBlbmRDaGlsZChodG1sRmFjdG9yeS5idWlsZEZpZWxkc2V0KFwiUmV2aWV3XCIsIFwiUGxlYXNlIGVudGVyIHlvdXIgcmV2aWV3XCIsIFwicmV2aWV3LWlucHV0XCIpKTtcclxuICAgICAgICBsZXQgZHJvcGRvd25GaWVsZHNldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmaWVsZHNldFwiKTtcclxuICAgICAgICBsZXQgZHJvcGRvd25MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcclxuICAgICAgICBkcm9wZG93bkxhYmVsLnRleHRDb250ZW50ID0gXCJDaG9vc2UgbG9jYXRpb25cIjtcclxuICAgICAgICBkcm9wZG93bkZpZWxkc2V0LmFwcGVuZENoaWxkKGRyb3Bkb3duTGFiZWwpO1xyXG4gICAgICAgIGxldCBkcm9wZG93biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIik7XHJcbiAgICAgICAgZHJvcGRvd24uaWQgPSBcImRyb3Bkb3duXCI7XHJcbiAgICAgICAgZHJvcGRvd24ubmFtZSA9IFwibG9jYXRpb25cIjtcclxuICAgICAgICBhcGlNYW5hZ2VyLmdldFBsYWNlcygpXHJcbiAgICAgICAgICAgIC50aGVuKHBsYWNlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBwbGFjZXMuZm9yRWFjaChwbGFjZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRyb3Bkb3duLmFwcGVuZENoaWxkKGh0bWxGYWN0b3J5LmJ1aWxkT3B0aW9uKHBsYWNlLm5hbWUsIHBsYWNlLmlkKSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duRmllbGRzZXQuYXBwZW5kQ2hpbGQoZHJvcGRvd24pO1xyXG4gICAgICAgICAgICAgICAgbmV3SW50ZXJlc3RGb3JtLmFwcGVuZENoaWxkKGRyb3Bkb3duRmllbGRzZXQpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNhdmVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgICAgICAgICAgICAgc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZSBQb2ludCBPZiBJbnRlcmVzdFwiO1xyXG4gICAgICAgICAgICAgICAgc2F2ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZXZlbnRIYW5kbGVycy5oYW5kbGVTYXZlSW50ZXJlc3QpXHJcbiAgICAgICAgICAgICAgICBuZXdJbnRlcmVzdEZvcm0uYXBwZW5kQ2hpbGQoc2F2ZUJ1dHRvbik7XHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5Q29udGFpbmVyLmFwcGVuZENoaWxkKG5ld0ludGVyZXN0Rm9ybSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3SW50ZXJlc3RGb3JtO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfSxcclxuICAgIGJ1aWxkRWRpdEZvcm0obmFtZSwgZGVzY3JpcHRpb24sIGNvc3QsIHJldmlldywgcGxhY2UpIHtcclxuICAgICAgICBsZXQgZG9jdW1lbnRGcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG4gICAgICAgIGxldCBpbnRlcmVzdE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDJcIik7XHJcbiAgICAgICAgaW50ZXJlc3ROYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICBkb2N1bWVudEZyYWcuYXBwZW5kQ2hpbGQoaW50ZXJlc3ROYW1lKTtcclxuICAgICAgICBsZXQgaW50ZXJlc3REZXNjcmlwdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG4gICAgICAgIGludGVyZXN0RGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcclxuICAgICAgICBkb2N1bWVudEZyYWcuYXBwZW5kQ2hpbGQoaW50ZXJlc3REZXNjcmlwdGlvbik7XHJcbiAgICAgICAgbGV0IGNvc3RJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICAgICAgICBjb3N0SW5wdXQuaWQgPSBcImVkaXQtY29zdFwiO1xyXG4gICAgICAgIGlmIChjb3N0ICE9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIGNvc3RJbnB1dC5wbGFjZWhvbGRlciA9IGNvc3Q7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29zdElucHV0LnBsYWNlaG9sZGVyID0gXCJQbGVhc2UgZW50ZXIgY29zdFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkb2N1bWVudEZyYWcuYXBwZW5kQ2hpbGQoY29zdElucHV0KTtcclxuICAgICAgICBsZXQgcmV2aWV3SW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgcmV2aWV3SW5wdXQuaWQgPSBcImVkaXQtcmV2aWV3XCI7XHJcbiAgICAgICAgaWYgKHJldmlldyAhPT0gXCJcIikge1xyXG4gICAgICAgICAgICByZXZpZXdJbnB1dC5wbGFjZWhvbGRlciA9IHJldmlldztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXZpZXdJbnB1dC5wbGFjZWhvbGRlciA9IFwiUGxlYXNlIGVudGVyIHJldmlld1wiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkb2N1bWVudEZyYWcuYXBwZW5kQ2hpbGQocmV2aWV3SW5wdXQpO1xyXG4gICAgICAgIGxldCBzYXZlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcclxuICAgICAgICBzYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlIENoYW5nZXNcIjtcclxuICAgICAgICAvLyBzYXZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBldmVudEhhbmRsZXJzLmhhbmRsZVNhdmVJbnRlcmVzdClcclxuICAgICAgICBkb2N1bWVudEZyYWcuYXBwZW5kQ2hpbGQoc2F2ZUJ1dHRvbik7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50RnJhZztcclxuXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGJ1aWxkSFRNTCIsImltcG9ydCBhcGlNYW5hZ2VyIGZyb20gXCIuL2FwaU1hbmFnZXJcIlxyXG5pbXBvcnQgaHRtbEZhY3RvcnkgZnJvbSBcIi4vaHRtbEZhY3RvcnlcIlxyXG5pbXBvcnQgYnVpbGRIVE1MIGZyb20gXCIuL2J1aWxkSFRNTFwiO1xyXG5cclxuY29uc3QgZXZlbnRIYW5kbGVycyA9IHtcclxuICAgIGhhbmRsZVNhdmVJbnRlcmVzdCgpIHtcclxuICAgICAgICBsZXQgcGxhY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRyb3Bkb3duXCIpLnZhbHVlO1xyXG4gICAgICAgIGxldCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYW1lLWlucHV0XCIpLnZhbHVlO1xyXG4gICAgICAgIGxldCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVzY3JpcHRpb24taW5wdXRcIikudmFsdWU7XHJcbiAgICAgICAgbGV0IGNvc3QgPSBOdW1iZXIoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb3N0LWlucHV0XCIpLnZhbHVlKTtcclxuICAgICAgICBsZXQgcmV2aWV3ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXZpZXctaW5wdXRcIikudmFsdWU7XHJcblxyXG4gICAgICAgIGlmIChuYW1lID09PSBcIlwiIHx8IGRlc2NyaXB0aW9uID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhcGlNYW5hZ2VyLnBvc3RJbnRlcmVzdChodG1sRmFjdG9yeS5jcmVhdGVJbnRlcmVzdE9iamVjdChwbGFjZSwgbmFtZSwgZGVzY3JpcHRpb24sIGNvc3QsIHJldmlldykpXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcbiAgICBoYW5kbGVFZGl0SW50ZXJlc3QoKSB7XHJcbiAgICAgICAgbGV0IGludGVyZXN0SWQgPSBldmVudC50YXJnZXQuaWQuc3BsaXQoXCItLVwiKVsxXTtcclxuICAgICAgICBsZXQgaW50ZXJlc3REaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgaW50ZXJlc3QtZGl2LS0ke2ludGVyZXN0SWR9YCk7XHJcbiAgICAgICAgaW50ZXJlc3REaXYudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgICAgIGFwaU1hbmFnZXIuZ2V0SW50ZXJlc3QoaW50ZXJlc3RJZClcclxuICAgICAgICAgICAgLnRoZW4oaW50ZXJlc3QgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGludGVyZXN0RGl2LmFwcGVuZENoaWxkKGJ1aWxkSFRNTC5idWlsZEVkaXRGb3JtKGludGVyZXN0Lm5hbWUsIGludGVyZXN0LmRlc2NyaXB0aW9uLCBpbnRlcmVzdC5jb3N0LCBpbnRlcmVzdC5yZXZpZXcpKTtcclxuICAgICAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZXZlbnRIYW5kbGVycyIsImNvbnN0IGh0bWxGYWN0b3J5ID0ge1xyXG4gICAgYnVpbGRSZXF1aXJlZEZpZWxkc2V0KGxhYmVsVGV4dCwgcGxhY2Vob2xkZXJUZXh0LCBpbnB1dElkKSB7XHJcbiAgICAgICAgbGV0IGZpZWxkc2V0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZmllbGRzZXRcIik7XHJcbiAgICAgICAgbGV0IGxhYmVsRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XHJcbiAgICAgICAgbGFiZWxFbC50ZXh0Q29udGVudCA9IGxhYmVsVGV4dDtcclxuICAgICAgICBmaWVsZHNldEVsLmFwcGVuZENoaWxkKGxhYmVsRWwpO1xyXG4gICAgICAgIGxldCBpbnB1dEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgIGlucHV0RWwuaWQgPSBpbnB1dElkO1xyXG4gICAgICAgIGlucHV0RWwuc2V0QXR0cmlidXRlKFwicmVxdWlyZWRcIiwgXCJcIik7XHJcbiAgICAgICAgaW5wdXRFbC5yZXF1aXJlZCA9IHRydWU7XHJcbiAgICAgICAgaW5wdXRFbC5wbGFjZWhvbGRlciA9IHBsYWNlaG9sZGVyVGV4dDtcclxuICAgICAgICBmaWVsZHNldEVsLmFwcGVuZENoaWxkKGlucHV0RWwpO1xyXG4gICAgICAgIHJldHVybiBmaWVsZHNldEVsO1xyXG4gICAgfSxcclxuICAgIGJ1aWxkRmllbGRzZXQobGFiZWxUZXh0LCBwbGFjZWhvbGRlclRleHQsIGlucHV0SWQpIHtcclxuICAgICAgICBsZXQgZmllbGRzZXRFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmaWVsZHNldFwiKTtcclxuICAgICAgICBsZXQgbGFiZWxFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcclxuICAgICAgICBsYWJlbEVsLnRleHRDb250ZW50ID0gbGFiZWxUZXh0O1xyXG4gICAgICAgIGZpZWxkc2V0RWwuYXBwZW5kQ2hpbGQobGFiZWxFbCk7XHJcbiAgICAgICAgbGV0IGlucHV0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgaW5wdXRFbC5pZCA9IGlucHV0SWQ7XHJcbiAgICAgICAgaW5wdXRFbC5wbGFjZWhvbGRlciA9IHBsYWNlaG9sZGVyVGV4dDtcclxuICAgICAgICBmaWVsZHNldEVsLmFwcGVuZENoaWxkKGlucHV0RWwpO1xyXG4gICAgICAgIHJldHVybiBmaWVsZHNldEVsO1xyXG4gICAgfSxcclxuICAgIGJ1aWxkT3B0aW9uKG5hbWUsIGlkKSB7XHJcbiAgICAgICAgbGV0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XHJcbiAgICAgICAgb3B0aW9uLnZhbHVlID0gaWQ7XHJcbiAgICAgICAgb3B0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICByZXR1cm4gb3B0aW9uO1xyXG4gICAgfSxcclxuICAgIGNyZWF0ZUludGVyZXN0T2JqZWN0KHBsYWNlSWQsIG5hbWUsIGRlc2NyaXB0aW9uLCBjb3N0LCByZXZpZXcpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBcInBsYWNlSWRcIjogcGxhY2VJZCxcclxuICAgICAgICAgICAgXCJuYW1lXCI6IG5hbWUsXHJcbiAgICAgICAgICAgIFwiZGVzY3JpcHRpb25cIjogZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgIFwiY29zdFwiOiBjb3N0LFxyXG4gICAgICAgICAgICBcInJldmlld1wiOiByZXZpZXdcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGh0bWxGYWN0b3J5IiwiaW1wb3J0IGFwcGVuZEhUTUwgZnJvbSBcIi4vYXBwZW5kSFRNTFwiXHJcbmltcG9ydCBidWlsZEhUTUwgZnJvbSBcIi4vYnVpbGRIVE1MXCJcclxuXHJcbmFwcGVuZEhUTUwuYXBwZW5kSW50ZXJlc3RzKCkudGhlbihidWlsZEhUTUwuYnVpbGROZXdJbnRlcmVzdEZvcm0pOyJdfQ==
